#%% WITH / AS CONTEXT MANAGERS - PG 1114

WITH OPEN('UNTITLED2.PY') AS MYFILE:
    FOR LINE IN MYFILE:
        PRINT(LINE)



#%% THE CONTEXT MANAGEMENT PROTOCOL - PG 1116
        
CLASS CMP:
    DEF MESSAGE(SELF, ARG):
        PRINT('MESSAGE() :: ARG = ' + ARG)
    
    DEF __ENTER__(SELF):
        PRINT('__ENTER__() :: START')
        RETURN SELF
    
    DEF __EXIT__(SELF, EXC_TYPE, EXC_VALUE, EXC_TB):
        IF EXC_TYPE IS NONE:
            PRINT('__EXIT__() :: EXITING NORMALLY\N')
        ELSE:
            PRINT('__EXIT__() :: GOT AN EXCEPTION ', STR(EXC_TYPE))
            RETURN FALSE                              # PROPAGATE THE EXCEPTION


WITH CMP() AS CMP_OBJ:
    CMP_OBJ.MESSAGE('SOMETHING')
    
WITH CMP() AS CMP_OBJ:
    CMP_OBJ.MESSAGE('SOMETHING')
    RAISE TYPEERROR



#%% MULTIPLE CONTEXT MANAGERS - PG 1118
    
WITH OPEN('UNTITLED2.PY') AS FIN, OPEN('OUT.TXT', 'W') AS FOUT:
    FOR LINE_IN IN FIN:
        LINE_OUT = LINE_IN.UPPER()
        FOUT.WRITE(LINE_OUT)

PRINT(OPEN('OUT.TXT').READ())
     


#%%